<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />

<script type="text/javascript" src="http://cdn.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
<script type="text/javascript" src="http://cdn.robotwebtools.org/roslibjs/current/roslib.min.js"></script>

<script type="text/javascript" type="text/javascript">
  // Connecting to ROS
  // -----------------

  var ros = new ROSLIB.Ros({
    url : 'ws://localhost:9090'
  });

  ros.on('connection', function() {
    console.log('Connected to websocket server.');
  });

  ros.on('error', function(error) {
    console.log('Error connecting to websocket server: ', error);
  });

  ros.on('close', function() {
    console.log('Connection to websocket server closed.');
  });

  // Publishing a Topic
  // ------------------
  var movPos = new ROSLIB.Topic({
    ros : ros,
    name : '/robot_command_json',
    messageType : 'proper_abb/MsgRobotCommand'
  });

  function myFunction() {
    var position = new ROSLIB.Message({
      command : '{"move":[[800, 0, 1200], [0, 0, 1, 0]]}'
    });
    movPos.publish(position);
  }

  function myFunction2() {
    var position = new ROSLIB.Message({
      command : '{"move":[[1000, 0, 1000], [0, 0, 1, 0]]}'
    });
    movPos.publish(position);
  }

  function myFunction3() {
    var position = new ROSLIB.Message({
      command : '{"' + document.getElementById('texto1').value + '":' + document.getElementById('texto2').value + '}'
    });
    movPos.publish(position);
  }
  // Subscribing to a Topic
  // ----------------------

  // var listener = new ROSLIB.Topic({
  //   ros : ros,
  //   name : '/listener',
  //   messageType : 'std_msgs/String'
  // });
  //
  // listener.subscribe(function(message) {
  //   console.log('Received message on ' + listener.name + ': ' + message.data);
  //   listener.unsubscribe();
  // });


  // Getting and setting a param value
  // ---------------------------------

  // ros.getParams(function(params) {
  //   console.log(params);
  // });
  //
  // var maxVelX = new ROSLIB.Param({
  //   ros : ros,
  //   name : 'max_vel_y'
  // });
  //
  // maxVelX.set(0.8);
  // maxVelX.get(function(value) {
  //   console.log('MAX VAL: ' + value);
  // });
</script>
</head>

<body>
  <h1>Simple roslib Example</h1>
  <p>Mover entre duas posici√≥ns</p>
  <input id="clickMe" type="button" value="Posicion 1" onclick="myFunction();" />
  <input id="clickMe" type="button" value="Posicion 2" onclick="myFunction2();" />
  <p>Especificar comando</p>
  <form id="frm1" action="form_action.asp">
    Comando: <br><input type="text" name="fname" id="texto1"><br>
    Valor:   <br><input type="text" name="lname" id="texto2"><br><br>
    <input type="button" onclick="myFunction3()" value="Enviar">
  </form>
</body>
</html>
